{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class DataService {\n  constructor() {\n    this.STORAGE_KEY = 'cliniquecare_db_v1';\n    this.defaultDB = {\n      employes: [{\n        id: 1,\n        email: 'sami@clinique.tn',\n        adresse: 'Ariana',\n        telephone: '20202020',\n        nom: 'Sami',\n        prenom: 'Ben Ali',\n        cin: '12345678',\n        dateNaissance: '1985-06-15',\n        poste: 'Médecin Généraliste',\n        salaire: '3500 TND'\n      }, {\n        id: 2,\n        email: 'amina@clinique.tn',\n        adresse: 'Tunis',\n        telephone: '29123456',\n        nom: 'Amina',\n        prenom: 'Trabelsi',\n        cin: '87654321',\n        dateNaissance: '1990-03-02',\n        poste: 'Infirmière',\n        salaire: '1200 TND'\n      }],\n      contrats: [{\n        id: 1,\n        type: 'CDI',\n        employe: 'Sami Ben Ali',\n        dateDebut: '2025-01-01',\n        dateFin: '2026-01-01'\n      }, {\n        id: 2,\n        type: 'CDD',\n        employe: 'Amina Trabelsi',\n        dateDebut: '2025-06-01',\n        dateFin: '2025-12-01'\n      }],\n      presences: [{\n        id: 1,\n        employe: 'Sami Ben Ali',\n        date: '2025-10-01',\n        status: 'Présent'\n      }, {\n        id: 2,\n        employe: 'Amina Trabelsi',\n        date: '2025-10-01',\n        status: 'Absent'\n      }],\n      conges: [{\n        id: 1,\n        employe: 'Sami Ben Ali',\n        type: 'Annuel',\n        debut: '2025-08-01',\n        fin: '2025-08-10'\n      }, {\n        id: 2,\n        employe: 'Amina Trabelsi',\n        type: 'Maladie',\n        debut: '2025-09-05',\n        fin: '2025-09-08'\n      }],\n      paie: [{\n        id: 1,\n        employe: 'Sami Ben Ali',\n        mois: 'Septembre 2025',\n        montant: '3500 TND'\n      }, {\n        id: 2,\n        employe: 'Amina Trabelsi',\n        mois: 'Septembre 2025',\n        montant: '1200 TND'\n      }],\n      formations: [{\n        id: 1,\n        titre: 'Hygiène Hospitalière',\n        employe: 'Sami Ben Ali',\n        date: '2025-11-15'\n      }]\n    };\n    this.dbSubject = new BehaviorSubject(this.defaultDB);\n    this.db$ = this.dbSubject.asObservable();\n    this.db = this.loadDB() || this.defaultDB;\n    this.saveDB();\n  }\n  loadDB() {\n    try {\n      const raw = localStorage.getItem(this.STORAGE_KEY);\n      if (raw) {\n        return JSON.parse(raw);\n      }\n    } catch (e) {\n      console.error('Erreur parse localStorage:', e);\n      localStorage.removeItem(this.STORAGE_KEY);\n    }\n    return null;\n  }\n  saveDB() {\n    try {\n      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(this.db));\n      this.dbSubject.next({\n        ...this.db\n      });\n    } catch (e) {\n      console.error('Erreur de sauvegarde localStorage:', e);\n    }\n  }\n  // Generic methods\n  getItems(section) {\n    return this.db[section] || [];\n  }\n  addItem(section, item) {\n    if (!this.db[section]) {\n      this.db[section] = [];\n    }\n    this.db[section].push(item);\n    this.saveDB();\n  }\n  updateItem(section, id, item) {\n    const items = this.db[section];\n    const index = items.findIndex(x => x.id === id);\n    if (index > -1) {\n      items[index] = item;\n      this.saveDB();\n    }\n  }\n  deleteItem(section, id) {\n    this.db[section] = this.db[section].filter(e => e.id !== id);\n    this.saveDB();\n  }\n  // Specific getters\n  getEmployees() {\n    return this.getItems('employes');\n  }\n  getContracts() {\n    return this.getItems('contrats');\n  }\n  getPresences() {\n    return this.getItems('presences');\n  }\n  getLeaves() {\n    return this.getItems('conges');\n  }\n  getPayroll() {\n    return this.getItems('paie');\n  }\n  getTrainings() {\n    return this.getItems('formations');\n  }\n  static {\n    this.ɵfac = function DataService_Factory(t) {\n      return new (t || DataService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: DataService,\n      factory: DataService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","DataService","constructor","STORAGE_KEY","defaultDB","employes","id","email","adresse","telephone","nom","prenom","cin","dateNaissance","poste","salaire","contrats","type","employe","dateDebut","dateFin","presences","date","status","conges","debut","fin","paie","mois","montant","formations","titre","dbSubject","db$","asObservable","db","loadDB","saveDB","raw","localStorage","getItem","JSON","parse","e","console","error","removeItem","setItem","stringify","next","getItems","section","addItem","item","push","updateItem","items","index","findIndex","x","deleteItem","filter","getEmployees","getContracts","getPresences","getLeaves","getPayroll","getTrainings","factory","ɵfac","providedIn"],"sources":["C:\\Users\\samer\\Desktop\\DS WEB\\cliniquecare-angular\\src\\app\\services\\data.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { DatabaseSchema, Employee, Contract, Presence, Leave, Payroll, Training } from '../models/data.models';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DataService {\r\n  private readonly STORAGE_KEY = 'cliniquecare_db_v1';\r\n  \r\n  private defaultDB: DatabaseSchema = {\r\n    employes: [\r\n      {\r\n        id: 1,\r\n        email: 'sami@clinique.tn',\r\n        adresse: 'Ariana',\r\n        telephone: '20202020',\r\n        nom: 'Sami',\r\n        prenom: 'Ben Ali',\r\n        cin: '12345678',\r\n        dateNaissance: '1985-06-15',\r\n        poste: 'Médecin Généraliste',\r\n        salaire: '3500 TND'\r\n      },\r\n      {\r\n        id: 2,\r\n        email: 'amina@clinique.tn',\r\n        adresse: 'Tunis',\r\n        telephone: '29123456',\r\n        nom: 'Amina',\r\n        prenom: 'Trabelsi',\r\n        cin: '87654321',\r\n        dateNaissance: '1990-03-02',\r\n        poste: 'Infirmière',\r\n        salaire: '1200 TND'\r\n      }\r\n    ],\r\n    contrats: [\r\n      {\r\n        id: 1,\r\n        type: 'CDI',\r\n        employe: 'Sami Ben Ali',\r\n        dateDebut: '2025-01-01',\r\n        dateFin: '2026-01-01'\r\n      },\r\n      {\r\n        id: 2,\r\n        type: 'CDD',\r\n        employe: 'Amina Trabelsi',\r\n        dateDebut: '2025-06-01',\r\n        dateFin: '2025-12-01'\r\n      }\r\n    ],\r\n    presences: [\r\n      {\r\n        id: 1,\r\n        employe: 'Sami Ben Ali',\r\n        date: '2025-10-01',\r\n        status: 'Présent'\r\n      },\r\n      {\r\n        id: 2,\r\n        employe: 'Amina Trabelsi',\r\n        date: '2025-10-01',\r\n        status: 'Absent'\r\n      }\r\n    ],\r\n    conges: [\r\n      {\r\n        id: 1,\r\n        employe: 'Sami Ben Ali',\r\n        type: 'Annuel',\r\n        debut: '2025-08-01',\r\n        fin: '2025-08-10'\r\n      },\r\n      {\r\n        id: 2,\r\n        employe: 'Amina Trabelsi',\r\n        type: 'Maladie',\r\n        debut: '2025-09-05',\r\n        fin: '2025-09-08'\r\n      }\r\n    ],\r\n    paie: [\r\n      {\r\n        id: 1,\r\n        employe: 'Sami Ben Ali',\r\n        mois: 'Septembre 2025',\r\n        montant: '3500 TND'\r\n      },\r\n      {\r\n        id: 2,\r\n        employe: 'Amina Trabelsi',\r\n        mois: 'Septembre 2025',\r\n        montant: '1200 TND'\r\n      }\r\n    ],\r\n    formations: [\r\n      {\r\n        id: 1,\r\n        titre: 'Hygiène Hospitalière',\r\n        employe: 'Sami Ben Ali',\r\n        date: '2025-11-15'\r\n      }\r\n    ]\r\n  };\r\n\r\n  private db: DatabaseSchema;\r\n  private dbSubject = new BehaviorSubject<DatabaseSchema>(this.defaultDB);\r\n  public db$: Observable<DatabaseSchema> = this.dbSubject.asObservable();\r\n\r\n  constructor() {\r\n    this.db = this.loadDB() || this.defaultDB;\r\n    this.saveDB();\r\n  }\r\n\r\n  private loadDB(): DatabaseSchema | null {\r\n    try {\r\n      const raw = localStorage.getItem(this.STORAGE_KEY);\r\n      if (raw) {\r\n        return JSON.parse(raw);\r\n      }\r\n    } catch (e) {\r\n      console.error('Erreur parse localStorage:', e);\r\n      localStorage.removeItem(this.STORAGE_KEY);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private saveDB(): void {\r\n    try {\r\n      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(this.db));\r\n      this.dbSubject.next({ ...this.db });\r\n    } catch (e) {\r\n      console.error('Erreur de sauvegarde localStorage:', e);\r\n    }\r\n  }\r\n\r\n  // Generic methods\r\n  getItems<T>(section: keyof DatabaseSchema): T[] {\r\n    return (this.db[section] as T[]) || [];\r\n  }\r\n\r\n  addItem(section: keyof DatabaseSchema, item: any): void {\r\n    if (!this.db[section]) {\r\n      this.db[section] = [];\r\n    }\r\n    (this.db[section] as any[]).push(item);\r\n    this.saveDB();\r\n  }\r\n\r\n  updateItem(section: keyof DatabaseSchema, id: number, item: any): void {\r\n    const items = this.db[section] as any[];\r\n    const index = items.findIndex(x => x.id === id);\r\n    if (index > -1) {\r\n      items[index] = item;\r\n      this.saveDB();\r\n    }\r\n  }\r\n\r\n  deleteItem(section: keyof DatabaseSchema, id: number): void {\r\n    this.db[section] = (this.db[section] as any[]).filter(e => e.id !== id);\r\n    this.saveDB();\r\n  }\r\n\r\n  // Specific getters\r\n  getEmployees(): Employee[] {\r\n    return this.getItems<Employee>('employes');\r\n  }\r\n\r\n  getContracts(): Contract[] {\r\n    return this.getItems<Contract>('contrats');\r\n  }\r\n\r\n  getPresences(): Presence[] {\r\n    return this.getItems<Presence>('presences');\r\n  }\r\n\r\n  getLeaves(): Leave[] {\r\n    return this.getItems<Leave>('conges');\r\n  }\r\n\r\n  getPayroll(): Payroll[] {\r\n    return this.getItems<Payroll>('paie');\r\n  }\r\n\r\n  getTrainings(): Training[] {\r\n    return this.getItems<Training>('formations');\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}